sudo: required
language: go
go:
  - "1.12beta2"
go_import_path: github.com/xiaokangwang/AndroidLibV2ray
git:
  depth: 1
addons:
  apt:
    update: true
before_script:
- sudo ntpdate -u time.google.com
- date
- make all
- make downloadGoMobile
- make buildVGO
script:
- go test -p 1 -tags json -v github.com/xiaokangwang/AndroidLibV2ray/...
after_success:
deploy:
  provider: releases
  api_key:
    secure:
  file:
    - libv2ray.aar
  skip_cleanup: true
  on:
    tags: true
